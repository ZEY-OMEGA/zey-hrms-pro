(Authentication & Authorization)

```python
# security/auth_manager.py
# Ù…Ø¯ÙŠØ± Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
# Ù…Ø¤Ø³Ø³Ø© Ø²Ø§ÙŠ Ø£ÙˆÙ…ÙŠÙ‚Ø§ Ù„Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ - [Ø§Ø³Ù…Ùƒ]ØŒ 2025

import hashlib
import secrets
from datetime import datetime, timedelta
from typing import Dict, Optional


class AuthManager:
    """
    Ù†Ø¸Ø§Ù… Ù…ØµØ§Ø¯Ù‚Ø© Ù…Ø¨Ø³Ø· Ù„Ù„Ø£Ù…Ø«Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©
    ÙÙŠ Ø¨ÙŠØ¦Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ©ØŒ ÙŠØ³ØªØ®Ø¯Ù… OAuth2 Ø£Ùˆ JWT
    """

    def __init__(self):
        # ØªØ®Ø²ÙŠÙ† ÙˆÙ‡Ù…ÙŠ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (ÙÙŠ Ø¨ÙŠØ¦Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ©: Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª)
        self.users = {
            "admin": {
                "password_hash": self._hash_password("admin123"),
                "role": "admin",
                "failed_attempts": 0,
                "locked_until": None
            },
            "principal": {
                "password_hash": self._hash_password("prin123"),
                "role": "principal",
                "failed_attempts": 0,
                "locked_until": None
            }
        }
        self.active_sessions = {}
        print("ğŸŸ¢ ØªÙ… ØªØ´ØºÙŠÙ„ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©")

    def _hash_password(self, password: str) -> str:
        """ØªØ´ÙÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"""
        salt = "zey-salt-2025"
        return hashlib.sha256((password + salt).encode()).hexdigest()

    def authenticate(self, username: str, password: str) -> Dict[str, Any]:
        """
        Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        """
        user = self.users.get(username)
        if not user:
            return {"success": False, "error": "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± ØµØ­ÙŠØ­"}

        # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‚ÙÙ„
        if user["locked_until"] and datetime.now() < user["locked_until"]:
            remaining = (user["locked_until"] - datetime.now()).seconds
            return {"success": False, "error": f"Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…Ù‚ÙÙˆÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø¹Ø¯ {remaining} Ø«Ø§Ù†ÙŠØ©"}

        # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        if user["password_hash"] != self._hash_password(password):
            user["failed_attempts"] += 1
            if user["failed_attempts"] >= 5:
                user["locked_until"] = datetime.now() + timedelta(minutes=15)
                return {"success": False, "error": "ØªÙ… ØªØ¬Ø§ÙˆØ² Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª. ØªÙ… Ù‚ÙÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨ Ù„Ù…Ø¯Ø© 15 Ø¯Ù‚ÙŠÙ‚Ø©"}
            return {"success": False, "error": "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©"}

        # Ù†Ø¬Ø§Ø­ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
        user["failed_attempts"] = 0
        session_token = secrets.token_urlsafe(32)
        self.active_sessions[session_token] = {
            "username": username,
            "role": user["role"],
            "created_at": datetime.now()
        }
        return {"success": True, "session_token": session_token, "role": user["role"]}

    def validate_session(self, session_token: str) -> bool:
        """Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¬Ù„Ø³Ø©"""
        return session_token in self.active_sessions

    def logout(self, session_token: str) -> bool:
        """ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬"""
        if session_token in self.active_sessions:
            del self.active_sessions[session_token]
            return True
        return False
```